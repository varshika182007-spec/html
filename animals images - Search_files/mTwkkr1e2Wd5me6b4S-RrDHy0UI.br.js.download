var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(o){if(e)throw new TypeError("Generator is already executing.");while(f&&(f=0,o[0]&&(r=0)),r)try{if(e=1,u&&(i=o[0]&2?u["return"]:o[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,o[1])).done)return i;(u=0,i)&&(o=[o[0]&2,i.value]);switch(o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++;u=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1];i=o;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(o);break}i[2]&&r.ops.pop();r.trys.pop();continue}o=t.call(n,r)}catch(s){o=[6,s];u=0}finally{e=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},e,u,i,f;return f={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f};(function(){function k(){return typeof _G!="undefined"&&_G.EF!==undefined&&_G.EF.instantsearchstorequery!==undefined&&_G.EF.instantsearchstorequery===1}function d(n,t){var i,e,o;if((i=window===null||window===void 0?void 0:window.navigator)===null||i===void 0?void 0:i.sendBeacon){var r=(new Date).getTime(),u=n.replace(/]]>/g,""),f=t.replace(/]]>/g,"");_G.DirectLogPost!=null?_w.directLogPost("Event.ClientInst",_G.IG,r,'{T:"CI.AutoSearch",FID:"CI",Name:"'.concat(u,'",Text:"').concat(f,'"}'),1,window.navigator.sendBeacon):(e="<E><T>Event.ClientInst<\/T><IG>".concat(_G.IG,"<\/IG><TS>").concat(r,'<\/TS><D><![CDATA[{T:"CI.AutoSearch",FID:"CI",Name:"').concat(u,'",Text:"').concat(f,'"}]\]><\/D><\/E>'),o="<ClientInstRequest><Events>".concat(e,"<\/Events><STS>").concat(r,"<\/STS><\/ClientInstRequest>"),window.navigator.sendBeacon("/fd/ls/lsp.aspx?",o))}}function v(n,t){return c(n)===c(t)}function c(n){return(n===null||n===void 0?void 0:n.toLowerCase())||""}function i(n){return(n===null||n===void 0?void 0:n.value)||""}function g(){var n=new URL(_w.location.href);return n.searchParams.get("q")||""}function y(n,i,o){return o===void 0&&(o=!0),__awaiter(this,void 0,void 0,function(){var a,s,v,l,h,y;return __generator(this,function(w){switch(w.label){case 0:if(!n)return[2];if(n.length<r)return _w.sj_log&&sj_log("CI.AutoSearch","queryTooShort","Query length ".concat(n.length," is less than minChars ").concat(r)),[2];if(a=n.length>u?n.substring(0,u):n,s=c(a),f&&f===s)return _w.sj_log&&sj_log("CI.AutoSearch","queryListCached","Skipping request for query: ".concat(s)),[2];e=s;v="/instantsearch/getquerylist?query=".concat(encodeURIComponent(s));w.label=1;case 1:return w.trys.push([1,4,,5]),[4,fetch(v)];case 2:if(l=w.sent(),!l.ok)throw new Error("HTTP error! status: ".concat(l.status));return e!==s?(_w.sj_log&&sj_log("CI.AutoSearch","queryListStale","Discarding stale response for: ".concat(s,", current pending: ").concat(e)),[2]):[4,l.json()];case 3:return h=w.sent(),h&&h.QueryList&&h.QueryList.length>0?(t=h,f=s,_w.sj_log&&sj_log("CI.AutoSearch","queryListFetched",""),o&&p(i)):_w.sj_log&&sj_log("CI.AutoSearch","queryListEmpty","QueryList is empty or missing"),[3,5];case 4:return y=w.sent(),_w.sj_log&&sj_log("CI.AutoSearch","queryListError",y.message),[3,5];case 5:return[2]}})})}function p(r){var u,e,f,o;return!s||n?!1:(u=i(r),e=g(),!u||v(u,e))?!1:(f=t===null||t===void 0?void 0:t.QueryList,!f)?!1:(o=f.some(function(n){return v(n.CandicateQuery,u)}),!o)?!1:(nt(),!0)}function l(n){p(n)||y(i(n),n)}function nt(){(d("trigger","autoSearch"),Log&&Log.LogFilterFlare&&Log.LogFilterFlare(["AutoSearchTriggered"]),a)||sj_evt.fire("autoTriggerNav",{form:"AUTOSE"})}function w(){var n=_d.getElementById(b),t;n&&(h&&!_w._isPersistSBF&&ut()&&rt(n),_w._isPersistSBF&&h||tt(n),t=i(n),t&&y(t,n,!1))}function tt(t){t.addEventListener("focus",function(){s=!0;Log&&Log.LogFilterFlare&&Log.LogFilterFlare(["SearchBoxFocused"])});t.addEventListener("blur",function(){s=n=!1});t.addEventListener("input",function(r){var u=r;o=i(t);switch(u.inputType){case"insertText":case"insertFromPaste":case"deleteContentForward":case"deleteContentBackward":if(n)break;l(t)}});t.addEventListener("change",function(){o=i(t)});t.addEventListener("compositionstart",function(){n=!0});t.addEventListener("compositionend",function(){n=!1;l(t)});sj_evt.bind("AS.Ghost.Applied",function(){n||l(t)},!0)}function it(){h=!0;t=null;f=null;e=null;w()}function rt(n){k()&&o!==null&&(n.value=o);n.focus();var t=n.value.length;n===null||n===void 0?void 0:n.setSelectionRange(t,t)}function ut(){var n=new URLSearchParams(window.location.search);return n.get("form")==="AUTOSE"}var b="sb_form_q",s=!1,n=!1,a=!1,r=3,u=30,h=!1,t=null,f=null,e=null,o=null;sj_evt.bind("searchBoxAutoSearchInit",function(n){var t=n[1],i=t.isControl,f=t.minChars,e=t.maxChars;a=i;r=f||r;u=e||u;w();sj_evt.bind("ajax.postload",it)},!0)})()